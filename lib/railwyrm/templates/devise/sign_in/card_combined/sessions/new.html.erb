<% email_value = params.dig(resource_name, :email) || params.dig(resource_name, "email") || resource&.email %>
<% remember_checked = params.dig(resource_name, :remember_me).to_s == "1" || params.dig(resource_name, "remember_me").to_s == "1" %>

<div class="min-h-screen bg-primary px-4 sm:px-6 lg:px-8">
  <div class="mx-auto flex min-h-screen w-full max-w-2xl items-center justify-center">
    <div class="w-full rounded-2xl bg-secondary_subtle p-3 shadow-2xl ring-1 ring-secondary">
    <div class="rounded-xl bg-primary px-8 py-10 sm:px-10">
      <div class="mb-6 flex items-start justify-between gap-4">
        <div>
          <p class="text-sm font-semibold text-brand-secondary">Railwyrm Access</p>
          <h1 class="mt-1 text-display-sm font-semibold text-primary">Sign in</h1>
          <p class="mt-1 text-sm text-tertiary">Enter your credentials to continue.</p>
        </div>
        <div class="rounded-lg bg-brand-primary_alt px-3 py-1 text-xs font-semibold text-brand-secondary">Secure</div>
      </div>

      <% if flash[:alert].present? %>
        <div class="mb-4 rounded-lg bg-error-primary px-3 py-2 text-sm text-error-primary">
          <%= flash[:alert] %>
        </div>
      <% end %>

      <% if flash[:notice].present? %>
        <div class="mb-4 rounded-lg bg-success-primary px-3 py-2 text-sm text-success-primary">
          <%= flash[:notice] %>
        </div>
      <% end %>

      <%= form_for(resource, as: resource_name, url: session_path(resource_name), html: { class: "space-y-6" }) do |f| %>
        <%= render Ui::Input::Component.new(
          label: "Work email",
          type: "email",
          name: "#{resource_name}[email]",
          value: email_value,
          placeholder: "you@company.com",
          required: true,
          size: :md
        ) %>

        <%= render Ui::Input::Component.new(
          label: "Password",
          type: "password",
          name: "#{resource_name}[password]",
          placeholder: "••••••••",
          required: true,
          size: :md
        ) %>

        <div class="flex items-center justify-between gap-3">
          <% if devise_mapping.rememberable? %>
            <%= render Ui::Checkbox::Component.new(
              label: "Remember for 30 days",
              name: "#{resource_name}[remember_me]",
              value: "1",
              checked: remember_checked,
              size: :sm
            ) %>
          <% end %>

          <% if devise_mapping.recoverable? %>
            <%= link_to "Forgot password?", new_password_path(resource_name), class: "text-sm font-medium text-brand-secondary hover:text-brand-secondary_hover" %>
          <% end %>
        </div>

        <div class="pt-1">
          <%= render Ui::Button::Component.new(type: "submit", size: :md, class: "w-full justify-center") do %>
            Sign in
          <% end %>
        </div>
      <% end %>

      <% if devise_mapping.registerable? %>
        <p class="mt-6 text-center text-sm text-tertiary">
          New here?
          <%= link_to "Create an account", new_registration_path(resource_name), class: "font-semibold text-brand-secondary hover:text-brand-secondary_hover" %>
        </p>
      <% end %>
    </div>
    </div>
  </div>
</div>
